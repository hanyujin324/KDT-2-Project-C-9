<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>천문현상 API도 화면에 불러오기</title>
</head>

<body>
  <div id="root"></div>
  <script>
    // 날짜 locdate 천문현상명 astroTitle 천문현상시간 astroTime 천문현상설명 astroEvent
    //div2순서 날짜+천문형상명-> 시간->천문현상 설명
    // 한번에 나타내기
    function getmoonValue(xmlData) {
      const parser = new DOMParser();
      const xmlDoc = parser.parseFromString(xmlData, "application/xml");
      const locdate = xmlDoc.querySelector("locdate").textContent.trim();
      const astroEvent = xmlDoc.querySelector("astroEvent").textContent.trim();

      return { locdate, astroEvent };
    }


    /*     // 날짜 불러오기
        function getlocdateValue(xmlData) {
          const parser = new DOMParser();
          const xmlDoc = parser.parseFromString(xmlData, "application/xml");
          const locdate = xmlDoc.querySelector("locdate").textContent.trim();
          return locdate;
        }
    
    
    
        // 천문현상 설명 불러오기
        function getastroEventValue(xmlData) {
          // XML 데이터에서 astroEvent 값을 가져오는 함수
          const parser = new DOMParser();
          const xmlDoc = parser.parseFromString(xmlData, "application/xml");
          const astroEvent = xmlDoc.querySelector("astroEvent").textContent.trim();
          return astroEvent;
        }
     */

    var xhr = new XMLHttpRequest();
    var url = 'http://apis.data.go.kr/B090041/openapi/service/AstroEventInfoService/getAstroEventInfo'; /*URL*/
    var queryParams = '?' + encodeURIComponent('serviceKey') + '=' + 'sLG8GxH%2BnJvDMU0R5HXBeGf0uKnmavrshGmvC%2F6x9JHxF1aAqG2gImPUoAnS0HcwF3u9y7VvXKUm%2B1skVniFcQ%3D%3D'; /*Service Key*/
    queryParams += '&' + encodeURIComponent('solYear') + '=' + encodeURIComponent('2023'); /**/
    queryParams += '&' + encodeURIComponent('solMonth') + '=' + encodeURIComponent('05'); /**/
    xhr.open('GET', url + queryParams);
    xhr.onreadystatechange = function () {
      console.log(xhr.response);
      var xmlData = xhr.responseText;
      var { locdate, astroEvent } = getmoonValue(xmlData);

      const root = document.getElementById("root");

      root.textContent =
        "날짜:" + locdate + "(년/월)" + "천문현상 설명: " + astroEvent


    };

    xhr.send('');
  </script>
</body>

</html>